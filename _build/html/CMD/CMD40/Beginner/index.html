<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beginner course @ CMD40 &mdash; STATE hands-on tutorial  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Advanced course @ CMD40" href="../Advanced/index.html" />
    <link rel="prev" title="Welcome to the STATE hands-on tutorial!" href="../../../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> STATE hands-on tutorial
            <img src="../../../_static/state_logo_1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Beginner course &#64; CMD40</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#silicon">Silicon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scf">SCF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cell-optimization">Cell optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aluminum">Aluminum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">SCF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nickel">Nickel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">SCF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ethylene">Ethylene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#geometry-optimization">Geometry optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vibrational-analyis">Vibrational analyis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finite-temperature-molecular-dynamics">Finite temperature molecular dynamics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cl-on-al-100">Cl on Al(100)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#geometry-optimization-with-pbc">Geometry optimization with PBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geometry-optimization-with-the-esm-method">Geometry optimization with the ESM method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-of-the-effective-and-electrostatic-potentials">Analysis of the effective and electrostatic potentials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#graphene">Graphene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Cell optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#band-structure-calculation">Band structure calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-of-states">Density of states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#benzene">Benzene</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">SCF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tio2">TiO2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/index.html">Advanced course &#64; CMD40</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">STATE hands-on tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Beginner course &#64; CMD40</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/CMD/CMD40/Beginner/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="beginner-course-cmd40">
<span id="cmd40-beginner"></span><h1>Beginner course &#64; CMD40<a class="headerlink" href="#beginner-course-cmd40" title="Permalink to this headline">¶</a></h1>
<p>Welcome to the STATE hands-on tutorial at CMD40. In the following, how to run the STATE examples for this hands on is desdribed.</p>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>First of all, we login the cluster system.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ssh -Y <span class="o">[</span>user_name<span class="o">]</span>@pyxis.mp.es.osaka-u.ac.jp
</pre></div>
</div>
<p>where [user_name] is your user name assigned.</p>
<p>Then, we are going to set up the STATE program, pseudopotentials, and example files.
This is done by executing the following command in the home directory (<code class="docutils literal notranslate"><span class="pre">${HOME}</span></code> or <code class="docutils literal notranslate"><span class="pre">~</span></code>) as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/ikuhamada/state-setup.git STATE
</pre></div>
</div>
<p>See also <a class="reference external" href="https://github.com/ikuhamada/state-setup">my github page</a>.</p>
<p>Then, go to the STATE directory</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> STATE
</pre></div>
</div>
<p>and execute the following</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./state-setup.sh
</pre></div>
</div>
<p>and you are all set!</p>
<p>The source file is located in <code class="docutils literal notranslate"><span class="pre">${HOME}/STATE/src</span></code> and examples <code class="docutils literal notranslate"><span class="pre">${HOME}/STATE/examples</span></code>.
Go to the STATE directory by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/STATE
</pre></div>
</div>
<p>and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ls
</pre></div>
</div>
<p>you can find the directories as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span><span class="o">/</span>  <span class="n">gncpp</span><span class="o">/</span>  <span class="n">src</span><span class="o">/</span>
</pre></div>
</div>
<p>Let us move to <code class="docutils literal notranslate"><span class="pre">${HOME}/STATE/examples</span></code>.</p>
<p>As the first example, let us use the carbon monoxide (CO) molecule in a box.
Go to <code class="docutils literal notranslate"><span class="pre">CO</span></code> in the examples directory, and  have a look at by <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">nfinp_scf</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>WF_OPT    DAV
NTYP      <span class="m">2</span>
NATM      <span class="m">2</span>
GMAX      <span class="m">5</span>.50
GMAXP     <span class="m">20</span>.00
NSCF      <span class="m">200</span>
WAYMIX    <span class="m">3</span>
KBXMIX    <span class="m">8</span>
MIX_ALPHA <span class="m">0</span>.8
WIDTH     <span class="m">0</span>.0010
EDELTA    <span class="m">0</span>.1000D-09
NEG       <span class="m">8</span>
CELL      <span class="m">6</span>.00  <span class="m">4</span>.00  <span class="m">4</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
<span class="p">&amp;</span>ATOMIC_SPECIES
 C  <span class="m">12</span>.011  pot.C_pbe1
 O  <span class="m">15</span>.999  pot.O_pbe1
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES
  <span class="m">0</span>.0000  <span class="m">0</span>.0000  <span class="m">0</span>.0000  <span class="m">1</span>  <span class="m">1</span>  <span class="m">1</span>
  <span class="m">2</span>.2000  <span class="m">0</span>.0000  <span class="m">0</span>.0000  <span class="m">1</span>  <span class="m">1</span>  <span class="m">2</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>Short description of the input variables can be found <a class="reference internal" href="co.html"><span class="doc">here</span></a></p>
<p>Let us review the job script by <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">qsub_cmd.sh</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#$ -S /bin/sh</span>
<span class="c1">#$ -cwd</span>
<span class="c1">#$ -q all.q</span>
<span class="c1">#$ -pe smp 4</span>
<span class="c1">#$ -N CO</span>

<span class="c1"># Disable OPENMP parallelism</span>

setenv OMP_NUM_THREADS <span class="m">1</span>

<span class="c1"># Set the execuable of the STATE code</span>

ln -fs <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/STATE/src/state/src/STATE .

<span class="c1"># Set the pseudopotential data</span>

ln -fs ../gncpp/pot.C_pbe1
ln -fs ../gncpp/pot.O_pbe1

<span class="c1"># Set the input/output file</span>

<span class="nv">INPUT_FILE</span><span class="o">=</span>nfinp_scf
<span class="nv">OUTPUT_FILE</span><span class="o">=</span>nfout_scf

<span class="c1"># Run!</span>

mpirun -np <span class="nv">$NSLOTS</span> ./STATE &lt; <span class="si">${</span><span class="nv">INPUT_FILE</span><span class="si">}</span> &gt; <span class="si">${</span><span class="nv">OUTPUT_FILE</span><span class="si">}</span>
</pre></div>
</div>
<p>and submit!</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">nfout_scf</span></code> starts with the header</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>***********************************************************************
*                                                                     *
*                                                                     *
*                                                                     *
*              ******  ********    **    ******** ********            *
*             ******** ********   ****   ******** ********            *
*             **          **     **  **     **    **                  *
*              ***        **    ********    **    ******              *
*                ***      **   **********   **    ******              *
*                  **     **  **        **  **    **                  *
*             ********    ** **          ** **    ********            *
*              ******     ** VERSION <span class="m">5</span>.6.9  **    ********            *
*                               RICS-AIST                             *
*                           OSAKA UNIVERSITY                          *
*                                                                     *
***********************************************************************
</pre></div>
</div>
<p>and at the convergence, total energy, its components, and Fermi energy are printed as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>      TOTAL ENERGY AND ITS COMPONENTS
   TOTAL <span class="nv">ENERGY</span>     <span class="o">=</span>         -22.21942426 A.U.
 KINETIC <span class="nv">ENERGY</span>     <span class="o">=</span>           <span class="m">9</span>.92111407 A.U.
 HARTREE <span class="nv">ENERGY</span>     <span class="o">=</span>           <span class="m">5</span>.12121800 A.U.
      XC <span class="nv">ENERGY</span>     <span class="o">=</span>          -5.89585641 A.U.
   LOCAL <span class="nv">ENERGY</span>     <span class="o">=</span>         -20.23161604 A.U.
NONLOCAL <span class="nv">ENERGY</span>     <span class="o">=</span>           <span class="m">6</span>.73686140 A.U.
   EWALD <span class="nv">ENERGY</span>     <span class="o">=</span>         -17.87114528 A.U.
      PC <span class="nv">ENERGY</span>     <span class="o">=</span>           <span class="m">0</span>.00000000 A.U.
ENTROPIC <span class="nv">ENERGY</span>     <span class="o">=</span>           <span class="m">0</span>.00000000 A.U.

                          FERMI <span class="nv">ENERGY</span> <span class="o">=</span>       <span class="m">0</span>.43248213
</pre></div>
</div>
<p>along with the forces acting on atoms</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>    ATOM              COORDINATES                        FORCES
MD:    <span class="m">1</span>
MD:    <span class="m">1</span>  C   <span class="m">0</span>.000000   <span class="m">0</span>.000000   <span class="m">0</span>.000000   <span class="m">0</span>.01852 -0.00000 -0.00000
MD:    <span class="m">2</span>  O   <span class="m">2</span>.200000   <span class="m">0</span>.000000   <span class="m">0</span>.000000  -0.01858  <span class="m">0</span>.00000 -0.00000
</pre></div>
</div>
<p>Congratulations! We see the victory cat at the end of the output file:-)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
                          _______________________
    __________   _______/______v______v______v___<span class="o">]</span>
   D          <span class="p">|</span> <span class="p">|</span>                                 <span class="p">|</span>
   D   A A    <span class="p">|</span> <span class="p">|</span> Congratulations!                <span class="p">|</span>  C<span class="o">(</span> &gt; &lt; <span class="o">)</span>D
 --  <span class="o">=(</span>^.^<span class="o">)=</span>  <span class="p">|</span> <span class="p">|</span>  The calculation has converged. <span class="p">|</span>    <span class="o">=</span> <span class="nv">o</span> <span class="o">=</span>
<span class="p">|</span>     @@@@@   <span class="p">|</span> <span class="p">|</span>                                 <span class="p">|</span>    <span class="o">(</span>    <span class="o">)</span>~
/--<span class="o">=</span><span class="nv">O</span><span class="o">=</span>-+-<span class="o">=</span><span class="nv">O</span><span class="o">=</span>---+--<span class="o">=</span><span class="nv">O</span><span class="o">=</span>--+--<span class="o">==</span><span class="nv">O</span><span class="o">==</span>--+--<span class="o">==</span><span class="nv">O</span><span class="o">==</span>--+--<span class="o">=</span><span class="nv">O</span><span class="o">=</span>-+--<span class="o">=</span><span class="nv">O</span><span class="o">=</span>---<span class="o">=</span><span class="nv">O</span><span class="o">=</span>-/

HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
</pre></div>
</div>
</section>
<section id="silicon">
<h2>Silicon<a class="headerlink" href="#silicon" title="Permalink to this headline">¶</a></h2>
<p>This example explains how to perform a self-consistent field (SCF) calculation and cell (volume) optimization by using a crystalline silicon in the diamond structure as an example.</p>
<section id="scf">
<h3>SCF<a class="headerlink" href="#scf" title="Permalink to this headline">¶</a></h3>
<p>In this example, we are going to use the input file <code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>.
Let us have a look at it by typing in the <code class="docutils literal notranslate"><span class="pre">Si</span></code> directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cat nfinp_scf
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Crystalline silicon in the diamond structure</span>
<span class="c1">#</span>
<span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">2</span>
<span class="n">NSPG</span>      <span class="mi">227</span>
<span class="n">GMAX</span>      <span class="mf">4.00</span>
<span class="n">GMAXP</span>     <span class="mf">8.00</span>
<span class="n">KPOINT_MESH</span>    <span class="mi">8</span>   <span class="mi">8</span>   <span class="mi">8</span>
<span class="n">KPOINT_SHIFT</span>   <span class="n">OFF</span> <span class="n">OFF</span> <span class="n">OFF</span>
<span class="n">WIDTH</span>     <span class="mf">0.0002</span>
<span class="n">EDELTA</span>    <span class="mf">0.5000</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="n">NEG</span>    <span class="mi">8</span>
<span class="n">CELL</span>   <span class="mf">10.30</span>  <span class="mf">10.30</span>  <span class="mf">10.30</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">Si</span> <span class="mf">28.0900</span> <span class="n">pot</span><span class="o">.</span><span class="n">Si_pbe1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.250000000000</span>      <span class="mf">0.250000000000</span>      <span class="mf">0.250000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>By default wave function optimization (single-point calculation) is performed (<code class="docutils literal notranslate"><span class="pre">WF_OPT</span></code>) with the Davidson algorithm (<code class="docutils literal notranslate"><span class="pre">DAV</span></code>), and structural optimization is not performed (Short description of the input variables can be found <a class="reference internal" href="si2.html"><span class="doc">here</span></a>).</p>
<p>Let us review the job script <code class="docutils literal notranslate"><span class="pre">qsub_cmd.sh</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#$ -S /bin/sh
#$ -cwd
#$ -q all.q
#$ -pe smp 4
#$ -N Si

#disable OPENMP parallelism
setenv OMP_NUM_THREADS 1

# execuable of the STATE code
ln -fs ${HOME}/STATE/src/state/src/STATE .

# pseudopotential data
ln -fs ../gncpp/pot.Si_pbe1

# launch STATE
mpirun -np $NSLOTS ./STATE &lt; nfinp_scf &gt; nfout_scf
</pre></div>
</div>
<p>By using the above input file and job script, we submit the job as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>Status of your job can be monitored by using <code class="docutils literal notranslate"><span class="pre">qstat</span></code> as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qstat
</pre></div>
</div>
<p>After the calculation is done, check the output file <code class="docutils literal notranslate"><span class="pre">nfout_scf</span></code> and make sure that lattice vectors and atomic positions are correct.
The primitive lattice vectors are given as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PRIM</span><span class="o">.</span> <span class="n">LAT</span><span class="o">.</span> <span class="n">VECTOR</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span> <span class="p">:</span>        <span class="mf">0.000000</span>       <span class="mf">5.150000</span>       <span class="mf">5.150000</span>
<span class="n">PRIM</span><span class="o">.</span> <span class="n">LAT</span><span class="o">.</span> <span class="n">VECTOR</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span> <span class="p">:</span>        <span class="mf">5.150000</span>       <span class="mf">0.000000</span>       <span class="mf">5.150000</span>
<span class="n">PRIM</span><span class="o">.</span> <span class="n">LAT</span><span class="o">.</span> <span class="n">VECTOR</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span> <span class="p">:</span>        <span class="mf">5.150000</span>       <span class="mf">5.150000</span>       <span class="mf">0.000000</span>
</pre></div>
</div>
<p>and atomic positions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*********************************</span> <span class="n">ATOMS</span> <span class="o">*******************************</span>
  <span class="n">ATOM</span>    <span class="n">X</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span>    <span class="n">Y</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span>    <span class="n">Z</span><span class="p">(</span><span class="n">BOHR</span><span class="p">)</span>     <span class="n">TAUX</span>    <span class="n">TAUY</span>    <span class="n">TAUZ</span> <span class="n">IW</span>  <span class="n">IR</span>
  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span>    <span class="mf">0.00000</span>   <span class="mf">0.0000</span>  <span class="mf">0.0000</span>  <span class="mf">0.0000</span>  <span class="mi">1</span>   <span class="mi">0</span>
  <span class="mi">2</span>  <span class="mi">1</span>    <span class="mf">2.57500</span>    <span class="mf">2.57500</span>    <span class="mf">2.57500</span>   <span class="mf">0.2500</span>  <span class="mf">0.2500</span>  <span class="mf">0.2500</span>  <span class="mi">1</span>   <span class="mi">0</span>
<span class="o">***********************************************************************</span>
</pre></div>
</div>
<p>The exchange-correlation functional used is printed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EXCHANGE</span> <span class="n">CORRELATION</span> <span class="n">FUNCTIONALS</span> <span class="p">:</span> <span class="n">ggapbe</span>
</pre></div>
</div>
<p>and make sure that this is what you want to use.</p>
<p>The convergence of the total energy can be monitored from the output. It looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***********************************************************************</span>
<span class="o">*</span>                                                                     <span class="o">*</span>
<span class="o">*</span>                              <span class="n">START</span> <span class="n">SCF</span>                              <span class="o">*</span>
<span class="o">*</span>                                                                     <span class="o">*</span>
<span class="o">***********************************************************************</span>

 <span class="n">NSCF</span> <span class="n">NADR</span>            <span class="n">ETOTAL</span>          <span class="n">EDEL</span>          <span class="n">CDEL</span> <span class="n">CONV</span>      <span class="n">TCPU</span>
    <span class="mi">1</span>    <span class="mi">0</span>       <span class="o">-</span><span class="mf">6.05513096</span>   <span class="mf">0.60551E+01</span>   <span class="mf">0.32033E-02</span>    <span class="mi">0</span>      <span class="mf">0.40</span>
    <span class="mi">2</span>    <span class="mi">1</span>       <span class="o">-</span><span class="mf">7.84013758</span>   <span class="mf">0.17850E+01</span>   <span class="mf">0.50625E-02</span>    <span class="mi">0</span>      <span class="mf">0.08</span>
    <span class="mi">3</span>    <span class="mi">2</span>       <span class="o">-</span><span class="mf">7.87244596</span>   <span class="mf">0.32308E-01</span>   <span class="mf">0.45624E-02</span>    <span class="mi">1</span>      <span class="mf">0.08</span>
    <span class="mi">4</span>    <span class="mi">3</span>       <span class="o">-</span><span class="mf">7.87086756</span>   <span class="mf">0.15784E-02</span>   <span class="mf">0.76306E-02</span>    <span class="mi">1</span>      <span class="mf">0.08</span>
    <span class="mi">5</span>    <span class="mi">4</span>       <span class="o">-</span><span class="mf">7.87352176</span>   <span class="mf">0.26542E-02</span>   <span class="mf">0.13466E-02</span>    <span class="mi">1</span>      <span class="mf">0.08</span>
    <span class="mi">6</span>    <span class="mi">5</span>       <span class="o">-</span><span class="mf">7.87351941</span>   <span class="mf">0.23528E-05</span>   <span class="mf">0.56367E-03</span>    <span class="mi">2</span>      <span class="mf">0.08</span>
    <span class="mi">7</span>    <span class="mi">6</span>       <span class="o">-</span><span class="mf">7.87353730</span>   <span class="mf">0.17887E-04</span>   <span class="mf">0.40389E-03</span>    <span class="mi">2</span>      <span class="mf">0.08</span>
    <span class="mi">8</span>    <span class="mi">7</span>       <span class="o">-</span><span class="mf">7.87355183</span>   <span class="mf">0.14538E-04</span>   <span class="mf">0.21148E-03</span>    <span class="mi">2</span>      <span class="mf">0.08</span>
    <span class="mi">9</span>    <span class="mi">8</span>       <span class="o">-</span><span class="mf">7.87355489</span>   <span class="mf">0.30598E-05</span>   <span class="mf">0.15435E-03</span>    <span class="mi">2</span>      <span class="mf">0.08</span>
   <span class="mi">10</span>    <span class="mi">9</span>       <span class="o">-</span><span class="mf">7.87355832</span>   <span class="mf">0.34247E-05</span>   <span class="mf">0.95948E-05</span>    <span class="mi">3</span>      <span class="mf">0.08</span>
   <span class="mi">11</span>   <span class="mi">10</span>       <span class="o">-</span><span class="mf">7.87355833</span>   <span class="mf">0.93097E-08</span>   <span class="mf">0.45654E-05</span>    <span class="mi">3</span>      <span class="mf">0.08</span>
   <span class="mi">12</span>   <span class="mi">11</span>       <span class="o">-</span><span class="mf">7.87355833</span>   <span class="mf">0.29345E-08</span>   <span class="mf">0.19696E-05</span>    <span class="mi">3</span>      <span class="mf">0.08</span>
   <span class="mi">13</span>   <span class="mi">12</span>       <span class="o">-</span><span class="mf">7.87355833</span>   <span class="mf">0.57462E-09</span>   <span class="mf">0.17709E-06</span>    <span class="mi">4</span>      <span class="mf">0.08</span>
   <span class="mi">14</span>   <span class="mi">13</span>       <span class="o">-</span><span class="mf">7.87355833</span>   <span class="mf">0.11322E-10</span>   <span class="mf">0.10973E-06</span>    <span class="mi">5</span>      <span class="mf">0.08</span>
   <span class="mi">15</span>   <span class="mi">14</span>       <span class="o">-</span><span class="mf">7.87355833</span>   <span class="mf">0.90061E-12</span>   <span class="mf">0.54074E-07</span>    <span class="mi">6</span>      <span class="mf">0.08</span>
</pre></div>
</div>
<p>At the convergence, the total energy and its componets are printed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">AND</span> <span class="n">ITS</span> <span class="n">COMPONENTS</span>
   <span class="n">TOTAL</span> <span class="n">ENERGY</span>     <span class="o">=</span>          <span class="o">-</span><span class="mf">7.87355833</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
 <span class="n">KINETIC</span> <span class="n">ENERGY</span>     <span class="o">=</span>           <span class="mf">3.01922477</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
 <span class="n">HARTREE</span> <span class="n">ENERGY</span>     <span class="o">=</span>           <span class="mf">0.55014239</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
      <span class="n">XC</span> <span class="n">ENERGY</span>     <span class="o">=</span>          <span class="o">-</span><span class="mf">2.40098667</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
   <span class="n">LOCAL</span> <span class="n">ENERGY</span>     <span class="o">=</span>          <span class="o">-</span><span class="mf">0.84295028</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
<span class="n">NONLOCAL</span> <span class="n">ENERGY</span>     <span class="o">=</span>           <span class="mf">0.16885308</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
   <span class="n">EWALD</span> <span class="n">ENERGY</span>     <span class="o">=</span>          <span class="o">-</span><span class="mf">8.36784162</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
      <span class="n">PC</span> <span class="n">ENERGY</span>     <span class="o">=</span>           <span class="mf">0.00000000</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
<span class="n">ENTROPIC</span> <span class="n">ENERGY</span>     <span class="o">=</span>           <span class="mf">0.00000000</span> <span class="n">A</span><span class="o">.</span><span class="n">U</span><span class="o">.</span>
</pre></div>
</div>
<p>NOTE this message is NOT printed when the convergence is not achieved.</p>
<p>In addition, total density of states (DOS) is printed to <code class="docutils literal notranslate"><span class="pre">dos.data</span></code>, which can be plotted with, for instantce, <code class="docutils literal notranslate"><span class="pre">gnuplot</span></code> as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot&gt; <span class="nb">set</span> xrange <span class="o">[</span>-12.5:7.5<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> yrange <span class="o">[</span><span class="m">0</span>:2.0<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> xlabel <span class="s1">&#39;Energy (eV)&#39;</span>
$ gnuplot&gt; <span class="nb">set</span> ylabel <span class="s1">&#39;DOS (arb. unit)&#39;</span>
$ gnuplot&gt; plot <span class="s1">&#39;dos.data&#39;</span> w l
</pre></div>
</div>
<p>The resulting DOS looks as follows:</p>
<a class="reference internal image-reference" href="../../../_images/dos_si_raw.png"><img alt="../../../_images/dos_si_raw.png" class="align-center" src="../../../_images/dos_si_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
</section>
<section id="cell-optimization">
<h3>Cell optimization<a class="headerlink" href="#cell-optimization" title="Permalink to this headline">¶</a></h3>
<p>In the current version of STATE, the stress tensor is not (yet!) calculated, and the cell optimization should be performed manually.
Let us change the lattice constant from 10.10 Bohr to 10.50 Bohr by 0.05 Bohr by changing the input variable <code class="docutils literal notranslate"><span class="pre">CELL</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL   <span class="m">10</span>.10  <span class="m">10</span>.10  <span class="m">10</span>.10  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL   <span class="m">10</span>.15  <span class="m">10</span>.15  <span class="m">10</span>.15  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
</pre></div>
</div>
<p>…</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL   <span class="m">10</span>.50  <span class="m">10</span>.50  <span class="m">10</span>.50  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
</pre></div>
</div>
<p>For each lattice constant we prepare an input file as <code class="docutils literal notranslate"><span class="pre">nfinp_scf_10.10</span></code>, <code class="docutils literal notranslate"><span class="pre">nfinp_scf_10.15</span></code>, … <code class="docutils literal notranslate"><span class="pre">nfinp_scf_10.50</span></code> and submit jobs by changing the input and output files in the job script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>To collect the volume-energy (E-V) data, here we use <code class="docutils literal notranslate"><span class="pre">state2ev.sh</span></code> script in <code class="docutils literal notranslate"><span class="pre">state-5.6.6/util/</span></code> as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ state2ev.sh nfout_scf_* &gt; etot.dat
</pre></div>
</div>
<p>This can be visualized by using, for example, <code class="docutils literal notranslate"><span class="pre">gnuplot</span></code> as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot&gt; plot <span class="s1">&#39;etot.dat&#39;</span> pt <span class="m">7</span>
</pre></div>
</div>
<p>The output looks like</p>
<a class="reference internal image-reference" href="../../../_images/etot_si_raw.png"><img alt="../../../_images/etot_si_raw.png" class="align-center" src="../../../_images/etot_si_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>Furthermore, by using the <code class="docutils literal notranslate"><span class="pre">eosfit</span></code> in the <code class="docutils literal notranslate"><span class="pre">util</span></code> directory, the equilibrium volume is obitained:</p>
<a class="reference internal image-reference" href="../../../_images/etot_si_fit.png"><img alt="../../../_images/etot_si_fit.png" class="align-center" src="../../../_images/etot_si_fit.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>The equilibrium volume (v0), energy (e0), bulk modulus (b0), and derivative of bulk modulus (b0’) can be found in <code class="docutils literal notranslate"><span class="pre">eosfit.param</span></code>.
The resulting equilibrium lattice constant is 10.3455 Bohr.
Compare with that reported in the literature.</p>
</section>
</section>
<section id="aluminum">
<h2>Aluminum<a class="headerlink" href="#aluminum" title="Permalink to this headline">¶</a></h2>
<p>In this example, how to deal with a metallic system with the smearing method is briefly described by using the crystalline aluminium in the face centered cubic (fcc) structure.</p>
<section id="id1">
<h3>SCF<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In the <code class="docutils literal notranslate"><span class="pre">Al</span></code> directory, we use the following input file for the SCF calculation.</p>
<p><code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Crystalline aluminum in the face centered cubic structure</span>
<span class="c1">#</span>
<span class="n">WF_OPT</span>  <span class="n">DAV</span>
<span class="n">NTYP</span>    <span class="mi">1</span>
<span class="n">NATM</span>    <span class="mi">1</span>
<span class="n">TYPE</span>    <span class="mi">2</span>
<span class="n">NSPG</span>    <span class="mi">221</span>
<span class="n">GMAX</span>    <span class="mf">4.00</span>
<span class="n">GMAXP</span>   <span class="mf">8.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">12</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">OFF</span> <span class="n">OFF</span> <span class="n">OFF</span>
<span class="n">SMEARING</span> <span class="n">MP</span>
<span class="n">WIDTH</span>   <span class="mf">0.0020</span>
<span class="n">EDELTA</span>  <span class="mf">0.5000</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="n">NEG</span>     <span class="mi">6</span>
<span class="n">CELL</span>    <span class="mf">7.50000000</span>   <span class="mf">7.50000000</span>   <span class="mf">7.50000000</span>  <span class="mf">90.00000000</span>  <span class="mf">90.00000000</span>  <span class="mf">90.00000000</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
<span class="n">Al</span> <span class="mf">26.9815386</span> <span class="n">pot</span><span class="o">.</span><span class="n">Al_pbe1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Here we set the smearing function of Methefessel and Paxton (MP) as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SMEARING MP
</pre></div>
</div>
<p>and smearing width</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>WIDTH  <span class="m">0</span>.0020
</pre></div>
</div>
<p>We can also use negative <code class="docutils literal notranslate"><span class="pre">WIDTH</span></code> without specifying <code class="docutils literal notranslate"><span class="pre">SMEARING</span></code> to enable the smearing function.
In this case the MP smearing function is automatically set.
See the manual for the available smearing functions.</p>
<p>Submit the STATE job as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub_cmd.sh
</pre></div>
</div>
<p>Total energy of the metallic system is sensitive to the smearing function and width, and the number of k-points, and they should be determined very carefully before the production run.
Detail is discussed in the tutorial (to be completed).</p>
</section>
</section>
<section id="nickel">
<h2>Nickel<a class="headerlink" href="#nickel" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to perform a calculation of a spin-polarized system using the ferromagnetic Ni in the fcc structure.</p>
<p>The directory is <code class="docutils literal notranslate"><span class="pre">Ni</span></code>.</p>
<section id="id2">
<h3>SCF<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Input file (<code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Ferromagnetic Ni in the fcc structure</span>
<span class="c1">#</span>
WF_OPT DAV
NTYP   <span class="m">1</span>
NATM   <span class="m">1</span>
TYPE   <span class="m">2</span>
NSPG   <span class="m">221</span>
GMAX    <span class="m">5</span>.00
GMAXP  <span class="m">15</span>.00
KPOINT_MESH   <span class="m">12</span>  <span class="m">12</span>  <span class="m">12</span>
KPOINT_SHIFT  OFF OFF OFF
MIX_ALPHA <span class="m">0</span>.3
SMEARING MP
WIDTH  <span class="m">0</span>.0020
EDELTA <span class="m">0</span>.5000D-09
NSPIN  <span class="m">2</span>
NBZTYP <span class="m">102</span>
NEG    <span class="m">10</span>
CELL   <span class="m">6</span>.70  <span class="m">6</span>.70  <span class="m">6</span>.70  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
<span class="p">&amp;</span>ATOMIC_SPECIES
 Ni <span class="m">58</span>.6900 pot.Ni_pbe4
<span class="p">&amp;</span>END
<span class="p">&amp;</span>INITIAL_ZETA
 <span class="m">0</span>.20
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES CRYSTAL
      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>To allow the spin polarized calculation, one has to set</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>NSPIN <span class="m">2</span>
</pre></div>
</div>
<p>along with the initial magnetization as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>INITIAL_ZETA
 <span class="m">0</span>.20
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>for each atomic species.</p>
<p>Submitting a job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>As above, <code class="docutils literal notranslate"><span class="pre">dos.data</span></code> is automatically generated. In the case of spin polarized system, the first column of <code class="docutils literal notranslate"><span class="pre">dos.data</span></code> contains energy, second and third columns contain DOS for spin up and down respectively.
This can be plotted by using gnuplot as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot&gt; <span class="nb">set</span> xrange <span class="o">[</span>-10:5<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> yrange <span class="o">[</span><span class="m">0</span>:4<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> xlabel <span class="s1">&#39;E-E_F (eV)&#39;</span>
$ gnuplot&gt; <span class="nb">set</span> ylabel <span class="s1">&#39;DOS (state/eV)&#39;</span>
$ gnuplot&gt; plot <span class="s1">&#39;dos.data_smearing&#39;</span> using <span class="o">(</span><span class="nv">$1</span><span class="o">)</span>:<span class="o">(</span><span class="nv">$2</span><span class="o">)</span> w l title <span class="s1">&#39;Spin-up&#39;</span>,<span class="s1">&#39;dos.data_smearing&#39;</span> using <span class="o">(</span><span class="nv">$1</span><span class="o">)</span>:<span class="o">(</span><span class="nv">$3</span><span class="o">)</span> w l title <span class="s1">&#39;Spin-down&#39;</span>
</pre></div>
</div>
<p>The spin-polarized DOS looks like:</p>
<a class="reference internal image-reference" href="../../../_images/dos_ni_raw_1.png"><img alt="../../../_images/dos_ni_raw_1.png" class="align-center" src="../../../_images/dos_ni_raw_1.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>Or by using the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gnuplot&gt; <span class="nb">set</span> xrange <span class="o">[</span>-10:5<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> yrange <span class="o">[</span>-4:4<span class="o">]</span>
$ gnuplot&gt; <span class="nb">set</span> yzeroaxis
$ gnuplot&gt; <span class="nb">set</span> xlabel <span class="s1">&#39;E-E_F (eV)&#39;</span>
$ gnuplot&gt; <span class="nb">set</span> ylabel <span class="s1">&#39;DOS (state/eV)&#39;</span>
$ gnuplot&gt; plot <span class="s1">&#39;dos.data_smearing&#39;</span> using <span class="o">(</span><span class="nv">$1</span><span class="o">)</span>:<span class="o">(</span><span class="nv">$2</span><span class="o">)</span> w l title <span class="s1">&#39;Spin-up&#39;</span>,<span class="s1">&#39;dos.data_smearing&#39;</span> using <span class="o">(</span><span class="nv">$1</span><span class="o">)</span>:<span class="o">(</span>-<span class="nv">$3</span><span class="o">)</span> w l title <span class="s1">&#39;Spin-down&#39;</span>
</pre></div>
</div>
<p>One may obtain the spin-polarized DOS like:</p>
<a class="reference internal image-reference" href="../../../_images/dos_ni_raw_2.png"><img alt="../../../_images/dos_ni_raw_2.png" class="align-center" src="../../../_images/dos_ni_raw_2.png" style="width: 603.2px; height: 549.6px;" /></a>
</section>
</section>
<section id="ethylene">
<h2>Ethylene<a class="headerlink" href="#ethylene" title="Permalink to this headline">¶</a></h2>
<p>This example explains how to perform the geometry optimization.</p>
<ul class="simple">
<li><p>Directory <code class="docutils literal notranslate"><span class="pre">C2H4</span></code></p></li>
<li><p>Input file <code class="docutils literal notranslate"><span class="pre">nfinp_gdiis</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Ethylene molecule in a box: geometry optimization with the GDIIS method</span>
<span class="c1">#</span>
WF_OPT  DAV
GEO_OPT GDIIS
NTYP   <span class="m">2</span>
NATM   <span class="m">6</span>
TYPE   <span class="m">0</span>
GMAX    <span class="m">5</span>.00
GMAXP  <span class="m">15</span>.00
MIX_ALPHA <span class="m">0</span>.8
WIDTH   <span class="m">0</span>.0010
EDELTA  <span class="m">0</span>.1000D-08
NEG     <span class="m">10</span>
FMAX    <span class="m">0</span>.5000D-03
CELL   <span class="m">12</span>.00  <span class="m">12</span>.00  <span class="m">12</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
<span class="p">&amp;</span>ATOMIC_SPECIES
 C  <span class="m">12</span>.0107  pot.C_pbe3
 H   <span class="m">1</span>.0079  pot.H_lda3
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES CARTESIAN
      <span class="m">1</span>.262722983300      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
      <span class="m">2</span>.348328846800      <span class="m">1</span>.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
      <span class="m">2</span>.348328846800     -1.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
     -1.262722983300      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
     -2.348328846800      <span class="m">1</span>.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
     -2.348328846800     -1.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>The keyword <code class="docutils literal notranslate"><span class="pre">GEO_OPT</span></code> is used to activate the geometry optimization.
In this example, GDIIS algorithm is employed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEO_OPT</span> <span class="n">GDIIS</span>
</pre></div>
</div>
<p>The force threshold for the geometry optimization is set by the keyword <code class="docutils literal notranslate"><span class="pre">FMAX</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FMAX</span>    <span class="mf">0.5000</span><span class="n">D</span><span class="o">-</span><span class="mi">03</span>
</pre></div>
</div>
<section id="geometry-optimization">
<h3>Geometry optimization<a class="headerlink" href="#geometry-optimization" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_gdiis_cmd.sh
</pre></div>
</div>
<p>The convergence of the forces can be monitored by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ grep -A1 f_max nfout_gdiis
</pre></div>
</div>
<p>The result looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">NIT</span>     <span class="n">TotalEnergy</span>     <span class="n">f_max</span>     <span class="n">f_rms</span>      <span class="n">edel</span>      <span class="n">vdel</span>      <span class="n">fdel</span>
     <span class="mi">1</span>    <span class="o">-</span><span class="mf">13.90231646</span>  <span class="mf">0.001396</span>  <span class="mf">0.001303</span>  <span class="mf">0.13</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">0.59</span><span class="n">D</span><span class="o">-</span><span class="mi">07</span>  <span class="mf">0.13</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>
<span class="o">--</span>
   <span class="n">NIT</span>     <span class="n">TotalEnergy</span>     <span class="n">f_max</span>     <span class="n">f_rms</span>      <span class="n">edel</span>      <span class="n">vdel</span>      <span class="n">fdel</span>
     <span class="mi">2</span>    <span class="o">-</span><span class="mf">13.90232125</span>  <span class="mf">0.001296</span>  <span class="mf">0.001109</span>  <span class="mf">0.45</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>  <span class="mf">0.47</span><span class="n">D</span><span class="o">-</span><span class="mi">07</span>  <span class="mf">0.45</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="o">--</span>
   <span class="n">NIT</span>     <span class="n">TotalEnergy</span>     <span class="n">f_max</span>     <span class="n">f_rms</span>      <span class="n">edel</span>      <span class="n">vdel</span>      <span class="n">fdel</span>
     <span class="mi">3</span>    <span class="o">-</span><span class="mf">13.90233075</span>  <span class="mf">0.000965</span>  <span class="mf">0.000788</span>  <span class="mf">0.27</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>  <span class="mf">0.13</span><span class="n">D</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">0.27</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="o">--</span>
   <span class="n">NIT</span>     <span class="n">TotalEnergy</span>     <span class="n">f_max</span>     <span class="n">f_rms</span>      <span class="n">edel</span>      <span class="n">vdel</span>      <span class="n">fdel</span>
     <span class="mi">4</span>    <span class="o">-</span><span class="mf">13.90234041</span>  <span class="mf">0.000562</span>  <span class="mf">0.000459</span>  <span class="mf">0.17</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>  <span class="mf">0.25</span><span class="n">D</span><span class="o">-</span><span class="mi">06</span>  <span class="mf">0.17</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>
<span class="o">--</span>
   <span class="n">NIT</span>     <span class="n">TotalEnergy</span>     <span class="n">f_max</span>     <span class="n">f_rms</span>      <span class="n">edel</span>      <span class="n">vdel</span>      <span class="n">fdel</span>
     <span class="mi">5</span>    <span class="o">-</span><span class="mf">13.90234848</span>  <span class="mf">0.000329</span>  <span class="mf">0.000271</span>  <span class="mf">0.11</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>  <span class="mf">0.91</span><span class="n">D</span><span class="o">-</span><span class="mi">07</span>  <span class="mf">0.11</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
</pre></div>
</div>
<p>The latest geometry is stored in the <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code> file, and in the case of GDIIS, past geometries are stored in <code class="docutils literal notranslate"><span class="pre">gdiis.data</span></code>.
It is suggested that <code class="docutils literal notranslate"><span class="pre">gdiis.data</span></code> be deleted or renamed when the number of optimization steps is close to the number of degrees of freedom.</p>
</section>
<section id="vibrational-analyis">
<h3>Vibrational analyis<a class="headerlink" href="#vibrational-analyis" title="Permalink to this headline">¶</a></h3>
<p>Having obtained the optimized geometry, let us perform the vibrational (normal) mode analysis.
This can be done in the following steps.</p>
<p>Frist, we need to create an input file with the optimized geometry.
This can be done by using a utility <code class="docutils literal notranslate"><span class="pre">geom2nfinp</span></code> as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ geom2nfinp -i nfinp_gdiis -g GEOMETRY -o nfinp_relaxed
</pre></div>
</div>
<p>where input parameters from <code class="docutils literal notranslate"><span class="pre">nfinp_gdiis</span></code> and atomic positions from <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code> are used to create a new input file <code class="docutils literal notranslate"><span class="pre">nfinp_relaxed</span></code>.
<code class="docutils literal notranslate"><span class="pre">geom2nfinp</span></code> can also be used to generate an XYZ/XSF file from the optimized geometry.
Type <code class="docutils literal notranslate"><span class="pre">geom2nfinp</span> <span class="pre">-h</span></code> for the usage of the command.</p>
<p>Then we copy <code class="docutils literal notranslate"><span class="pre">nfinp_relaxed</span></code> to <code class="docutils literal notranslate"><span class="pre">nfinp_vib</span></code> which looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Ethylene molecule in a box: geometry optimization with the GDIIS method</span>
<span class="c1">#</span>
<span class="n">TASK</span>   <span class="n">VIB</span>
<span class="n">WF_OPT</span> <span class="n">DAV</span>
<span class="n">NTYP</span>   <span class="mi">2</span>
<span class="n">NATM</span>   <span class="mi">6</span>
<span class="n">TYPE</span>   <span class="mi">0</span>
<span class="n">GMAX</span>    <span class="mf">5.00</span>
<span class="n">GMAXP</span>  <span class="mf">15.00</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.8</span>
<span class="n">WIDTH</span>   <span class="mf">0.0010</span>
<span class="n">EDELTA</span>  <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>
<span class="n">NEG</span>     <span class="mi">10</span>
<span class="n">FMAX</span>    <span class="mf">0.5000</span><span class="n">D</span><span class="o">-</span><span class="mi">03</span>
<span class="n">CELL</span>   <span class="mf">12.00</span>  <span class="mf">12.00</span>  <span class="mf">12.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span>  <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
 <span class="n">H</span>   <span class="mf">1.0079</span>  <span class="n">pot</span><span class="o">.</span><span class="n">H_lda3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CARTESIAN</span>
      <span class="mf">1.260767348060</span>     <span class="o">-</span><span class="mf">0.000000889176</span>      <span class="mf">0.000000061206</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">2.337934105040</span>      <span class="mf">1.755199776368</span>      <span class="mf">0.000000035554</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
      <span class="mf">2.337933682371</span>     <span class="o">-</span><span class="mf">1.755198581491</span>      <span class="mf">0.000000037135</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
     <span class="o">-</span><span class="mf">1.260766004354</span>     <span class="o">-</span><span class="mf">0.000000071340</span>      <span class="mf">0.000000050715</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
     <span class="o">-</span><span class="mf">2.337933757669</span>      <span class="mf">1.755199342527</span>      <span class="mf">0.000000064907</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
     <span class="o">-</span><span class="mf">2.337933482763</span>     <span class="o">-</span><span class="mf">1.755199042963</span>      <span class="mf">0.000000067944</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>We can see the new keyword <code class="docutils literal notranslate"><span class="pre">TASK</span> <span class="pre">VIB</span></code>, which enables one to perform the vibrational analysis.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure the atomic masses in the input file are those you want to use as
in some cases we use artificially large/small atomic masses for efficient structural optimization.</p>
</div>
<p>In addition to the input file, we need prepare <code class="docutils literal notranslate"><span class="pre">nfvibrate.data</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">1</span>
 <span class="mi">1</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">1</span>
 <span class="mi">1</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">2</span>
 <span class="mi">1</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">2</span>
 <span class="mi">1</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">3</span>
 <span class="mi">1</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">3</span>
 <span class="mi">1</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>
<span class="o">...</span>
<span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">16</span>
 <span class="mi">6</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">16</span>
 <span class="mi">6</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">17</span>
 <span class="mi">6</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">17</span>
 <span class="mi">6</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>   <span class="mf">0.0000000000</span>
<span class="mi">1</span>  <span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">18</span>
 <span class="mi">6</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.10</span><span class="n">D</span><span class="o">+</span><span class="mi">01</span>  <span class="mi">18</span>
 <span class="mi">6</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0000000000</span>   <span class="mf">0.0100000000</span>
</pre></div>
</div>
<p>In the present example, the file contains 2 x 2 x 6 x 3 = 72 lines, which define the atomic displacement in the cartesian coordinate.
This is 36 set of displacement composed of 2 lines (in this case).
Here I use first two lines as an example:</p>
<p>First line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span>  <span class="m">0</span>.10D+01   <span class="m">1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>First column : number of displacement(s)</p></li>
<li><p>Second column : factor for the displacement</p></li>
<li><p>Thrid column : dummy</p></li>
</ul>
<p>Second line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span>   <span class="m">0</span>.0100000000   <span class="m">0</span>.0000000000   <span class="m">0</span>.0000000000
</pre></div>
</div>
<ul class="simple">
<li><p>First column in the second line: the index for the atom displaced</p></li>
<li><p>Second-Fourth column in the second line: atomic displacement in the cartesian coordinate.</p></li>
</ul>
<p>Actual atomic displacements are atomic displacement (2-4th column in the second line multiplied by the factor).</p>
<p>Submit the job</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_vib_cmd.sh
</pre></div>
</div>
<p>and we get <code class="docutils literal notranslate"><span class="pre">nfforce.data</span></code> in addition to the standard output files, which contains displaced atomic positions and forces acting on atoms, which can be used to calculate the vibrational frequencies.</p>
<p>Then to calculate the dynamical matrix and vibrational frequencies, we use the <code class="docutils literal notranslate"><span class="pre">gif</span></code> program as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gif -f nfforce.data
</pre></div>
</div>
<p>and we can see the vibrational frequncies printed in the standard output as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>            <span class="o">=========</span>
             <span class="nv">SUMMARY</span>
            <span class="o">=========</span>

MODE  WR       : NU<span class="o">(</span>meV<span class="o">)</span>  NU<span class="o">(</span>cm-1<span class="o">)</span>
   <span class="m">1</span> -0.42D-03 :   <span class="m">12</span>.97    <span class="m">104</span>.63
   <span class="m">2</span> -0.19D-03 :    <span class="m">8</span>.76     <span class="m">70</span>.63
   <span class="m">3</span> -0.61D-04 :    <span class="m">4</span>.97     <span class="m">40</span>.06
   <span class="m">4</span> -0.18D-04 :    <span class="m">2</span>.67     <span class="m">21</span>.50
   <span class="m">5</span>  <span class="m">0</span>.30D-04 :    <span class="m">3</span>.46     <span class="m">27</span>.93
   <span class="m">6</span>  <span class="m">0</span>.28D-03 :   <span class="m">10</span>.71     <span class="m">86</span>.35
   <span class="m">7</span>  <span class="m">0</span>.25D-01 :  <span class="m">100</span>.48    <span class="m">810</span>.43
   <span class="m">8</span>  <span class="m">0</span>.32D-01 :  <span class="m">114</span>.17    <span class="m">920</span>.88
   <span class="m">9</span>  <span class="m">0</span>.34D-01 :  <span class="m">116</span>.25    <span class="m">937</span>.60
  <span class="m">10</span>  <span class="m">0</span>.41D-01 :  <span class="m">128</span>.26   <span class="m">1034</span>.48
  <span class="m">11</span>  <span class="m">0</span>.55D-01 :  <span class="m">148</span>.39   <span class="m">1196</span>.82
  <span class="m">12</span>  <span class="m">0</span>.68D-01 :  <span class="m">165</span>.42   <span class="m">1334</span>.18
  <span class="m">13</span>  <span class="m">0</span>.76D-01 :  <span class="m">175</span>.51   <span class="m">1415</span>.54
  <span class="m">14</span>  <span class="m">0</span>.10D+00 :  <span class="m">201</span>.49   <span class="m">1625</span>.12
  <span class="m">15</span>  <span class="m">0</span>.36D+00 :  <span class="m">379</span>.55   <span class="m">3061</span>.29
  <span class="m">16</span>  <span class="m">0</span>.36D+00 :  <span class="m">381</span>.80   <span class="m">3079</span>.41
  <span class="m">17</span>  <span class="m">0</span>.37D+00 :  <span class="m">388</span>.22   <span class="m">3131</span>.17
  <span class="m">18</span>  <span class="m">0</span>.38D+00 :  <span class="m">393</span>.55   <span class="m">3174</span>.18
</pre></div>
</div>
<p>The first column, the number of mode, the second column, square of the vibrational frequency in Hartree, and third and fourth columns are vibrational frequencies in meV and wavenumber (cm^-1), respectively.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>New data are always appended to the exsiting <code class="docutils literal notranslate"><span class="pre">nfforce.data</span></code>. Rename it when (a set of) calculations are finished.</p>
</div>
<p>Finally, we visualize the vibrational mode by using the <code class="docutils literal notranslate"><span class="pre">gif2xsf</span></code> utility.
To use <code class="docutils literal notranslate"><span class="pre">gif2xsf</span></code> we prepare an XSF, which can be created by using the <code class="docutils literal notranslate"><span class="pre">chkinpf</span></code> utility as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ chkinpf --atom nfinp_vib
</pre></div>
</div>
<p>By this we are able to create an XSF file for molecule (not periodic boundary condition).
Then type</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gif2xsf -s
</pre></div>
</div>
<p>Use C2H4.xsf for the XSF file, vib.data for VIB file, and vib for prefix, and we get vib_*.xsf, which can be visualized by using XCrySden or VESTA.</p>
</section>
<section id="finite-temperature-molecular-dynamics">
<h3>Finite temperature molecular dynamics<a class="headerlink" href="#finite-temperature-molecular-dynamics" title="Permalink to this headline">¶</a></h3>
<p>In this example, we are going to perform a finite temperature molecular dynamics simulation.</p>
<ul class="simple">
<li><p>Input file <code class="docutils literal notranslate"><span class="pre">nfinp_nhc</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Ethylene molecule in a box: geometry optimization with the GDIIS method</span>
<span class="c1">#</span>
WF_OPT  DAV
ION_DYN FTMD
NTYP   <span class="m">2</span>
NATM   <span class="m">6</span>
TYPE   <span class="m">0</span>
GMAX    <span class="m">5</span>.00
GMAXP  <span class="m">15</span>.00
MIX_ALPHA <span class="m">0</span>.8
WIDTH   <span class="m">0</span>.0010
EDELTA  <span class="m">0</span>.1000D-08
NEG     <span class="m">10</span>
TEMP_CONTROL NHC
TEMPW   <span class="m">300</span>.0D0
WNOSEP  <span class="m">500</span>.0D0
NHC     <span class="m">8</span>
NOSY    <span class="m">15</span>
NDRT    <span class="m">1</span>
CELL   <span class="m">12</span>.00  <span class="m">12</span>.00  <span class="m">12</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00  <span class="m">90</span>.00
<span class="p">&amp;</span>ATOMIC_SPECIES
 C  <span class="m">12</span>.0107  pot.C_pbe3
 H   <span class="m">1</span>.0079  pot.H_lda3
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES CARTESIAN
      <span class="m">1</span>.262722983300      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">1</span>
      <span class="m">2</span>.348328846800      <span class="m">1</span>.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">2</span>
      <span class="m">2</span>.348328846800     -1.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">2</span>
     -1.262722983300      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">1</span>
     -2.348328846800      <span class="m">1</span>.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">2</span>
     -2.348328846800     -1.753458668500      <span class="m">0</span>.000000000000    <span class="m">1</span> <span class="m">1001</span>    <span class="m">2</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>To perform a molecular dynamics simulation, we set <code class="docutils literal notranslate"><span class="pre">ION_DYN</span></code> `` FTMD`` and how to control the temperature is given as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEMP_CONTROL</span> <span class="n">NHC</span>
<span class="n">TEMPW</span>   <span class="mf">300.0</span><span class="n">D0</span>
<span class="n">WNOSEP</span>  <span class="mf">500.0</span><span class="n">D0</span>
<span class="n">NHC</span>     <span class="mi">8</span>
<span class="n">NOSY</span>    <span class="mi">15</span>
<span class="n">NDRT</span>    <span class="mi">1</span>
</pre></div>
</div>
<p>Submit the job</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_nhc_cmd.sh
</pre></div>
</div>
<p>In this example, we perform 200 MD steps (default value).
When the calculation is terminated, we get <code class="docutils literal notranslate"><span class="pre">TRAJECTORY</span></code> containing the trajectory and <code class="docutils literal notranslate"><span class="pre">ENERGIES</span></code> containing information on temperature and energies.</p>
<p>To visualize the trajectroy, first we need <code class="docutils literal notranslate"><span class="pre">GEOMETRY.xyz</span></code>, which can be generated by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ chkinpf --xyz nfinp_nhc -o GEOMETRY.xyz
</pre></div>
</div>
<p>Then use <code class="docutils literal notranslate"><span class="pre">traj2xyz.pl</span></code> in the current example directry as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./traj2xyz.pl &gt; traj.xyz
</pre></div>
</div>
<p>to save the trajectory in the XYZ format.</p>
<p>Use XCrySDen, VMD, or other your favorite visualization software to visualize it (VESTA cannot be used for movies).</p>
</section>
</section>
<section id="cl-on-al-100">
<h2>Cl on Al(100)<a class="headerlink" href="#cl-on-al-100" title="Permalink to this headline">¶</a></h2>
<p>This example explains how to model the surface with an adsobate by using an Al(100) surface with a Cl atom.
We also discuss how the periodic boundary condition (PBC) affects the potential (and thus the energy and forces)
and how to address the issue by using the effective screening medium (ESM) method.</p>
<section id="geometry-optimization-with-pbc">
<h3>Geometry optimization with PBC<a class="headerlink" href="#geometry-optimization-with-pbc" title="Permalink to this headline">¶</a></h3>
<p>Go to <code class="docutils literal notranslate"><span class="pre">ClonAl100</span></code> and use the following input file (<code class="docutils literal notranslate"><span class="pre">nfinp_gdiis_pbc</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Cl on Al(100)</span>
<span class="c1">#</span>
<span class="n">WF_OPT</span>  <span class="n">DAV</span>
<span class="n">GEO_OPT</span> <span class="n">GDIIS</span>
<span class="n">NTYP</span>    <span class="mi">2</span>
<span class="n">NATM</span>    <span class="mi">7</span>
<span class="n">NSPG</span>    <span class="mi">1</span>
<span class="n">GMAX</span>    <span class="mf">4.00</span>
<span class="n">GMAXP</span>  <span class="mf">10.00</span>
<span class="n">KPOINT_MESH</span>    <span class="mi">4</span>   <span class="mi">4</span>   <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>   <span class="n">ON</span>  <span class="n">ON</span>  <span class="n">OFF</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0020</span>
<span class="n">NEG</span>       <span class="mi">16</span>
<span class="n">MIX</span>       <span class="n">BROYDEN2</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.80</span>
<span class="n">EDELTA</span>   <span class="mf">1.000</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="n">DTIO</span>     <span class="mf">600.00</span>
<span class="n">FMAX</span>     <span class="mf">1.000</span><span class="n">D</span><span class="o">-</span><span class="mi">03</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">Al</span>  <span class="mf">26.9815</span> <span class="n">pot</span><span class="o">.</span><span class="n">Al_pbe1</span>
 <span class="n">Cl</span>  <span class="mf">35.4527</span> <span class="n">pot</span><span class="o">.</span><span class="n">Cl_pbe1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">CELL</span>
      <span class="mf">7.653400000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>
      <span class="mf">0.000000000000</span>      <span class="mf">7.653000000000</span>      <span class="mf">0.000000000000</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>     <span class="mf">30.613600000000</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CARTESIAN</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">3.700000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
      <span class="mf">0.000000000000</span>      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>     <span class="o">-</span><span class="mf">3.826700000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">3.826700000000</span>     <span class="o">-</span><span class="mf">3.826700000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">0.000000000000</span>      <span class="mf">3.826700000000</span>     <span class="o">-</span><span class="mf">7.653400000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>     <span class="o">-</span><span class="mf">7.653400000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>We see that how to define the lattice vectors differs from the previous examples.</p>
<p>Subit the STATE job by executing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>and we get <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code> and <code class="docutils literal notranslate"><span class="pre">gdiis.data</span></code> in addition to the standard output files.</p>
</section>
<section id="geometry-optimization-with-the-esm-method">
<h3>Geometry optimization with the ESM method<a class="headerlink" href="#geometry-optimization-with-the-esm-method" title="Permalink to this headline">¶</a></h3>
<p>We then use <code class="docutils literal notranslate"><span class="pre">nfinp_gdiis_esm</span></code> for the structural optimization with the effective screening medium method, which looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Cl on Al(100)</span>
<span class="c1">#</span>
<span class="n">WF_OPT</span>  <span class="n">DAV</span>
<span class="n">GEO_OPT</span> <span class="n">GDIIS</span>
<span class="n">NTYP</span>    <span class="mi">2</span>
<span class="n">NATM</span>    <span class="mi">7</span>
<span class="n">NSPG</span>    <span class="mi">1</span>
<span class="n">GMAX</span>    <span class="mf">4.00</span>
<span class="n">GMAXP</span>  <span class="mf">10.00</span>
<span class="n">KPOINT_MESH</span>    <span class="mi">4</span>   <span class="mi">4</span>   <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>   <span class="n">ON</span>  <span class="n">ON</span>  <span class="n">OFF</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0020</span>
<span class="n">NEG</span>       <span class="mi">16</span>
<span class="n">MIX</span>       <span class="n">BROYDEN2</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.80</span>
<span class="n">EDELTA</span>   <span class="mf">1.000</span><span class="n">D</span><span class="o">-</span><span class="mi">09</span>
<span class="n">DTIO</span>     <span class="mf">600.00</span>
<span class="n">FMAX</span>     <span class="mf">1.000</span><span class="n">D</span><span class="o">-</span><span class="mi">03</span>
<span class="o">&amp;</span><span class="n">ESM</span>
 <span class="n">BOUNDARY_CONDITION</span> <span class="n">BARE</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">Al</span>  <span class="mf">26.9815</span> <span class="n">pot</span><span class="o">.</span><span class="n">Al_pbe1</span>
 <span class="n">Cl</span>  <span class="mf">35.4527</span> <span class="n">pot</span><span class="o">.</span><span class="n">Cl_pbe1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">CELL</span>
      <span class="mf">7.653400000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>
      <span class="mf">0.000000000000</span>      <span class="mf">7.653000000000</span>      <span class="mf">0.000000000000</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>     <span class="mf">30.613600000000</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CARTESIAN</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">3.700000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">2</span>
      <span class="mf">0.000000000000</span>      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.000000000000</span>      <span class="mf">0.000000000000</span>     <span class="o">-</span><span class="mf">3.826700000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">3.826700000000</span>     <span class="o">-</span><span class="mf">3.826700000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">0.000000000000</span>      <span class="mf">3.826700000000</span>     <span class="o">-</span><span class="mf">7.653400000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
      <span class="mf">3.826700000000</span>      <span class="mf">0.000000000000</span>     <span class="o">-</span><span class="mf">7.653400000000</span>    <span class="mi">1</span>    <span class="mi">0</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Diffence from the previous calculation is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">ESM</span>
 <span class="n">BOUNDARY_CONDITION</span> <span class="n">BARE</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>This enables the ESM calculation.
In this case open boundary condition in the surface normal direction is used.</p>
</section>
<section id="analysis-of-the-effective-and-electrostatic-potentials">
<h3>Analysis of the effective and electrostatic potentials<a class="headerlink" href="#analysis-of-the-effective-and-electrostatic-potentials" title="Permalink to this headline">¶</a></h3>
<p>Here we analyze the potentials from PBC and ESM calculations.
Use <code class="docutils literal notranslate"><span class="pre">state2chgpro.sh</span></code> utility to extract planar average of charge, effective (Kohn-Sham) and electrostatic potentials as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ state2chgpro.sh nfout_gdiis_pbc &gt; chgpro.dat_pbc
</pre></div>
</div>
<p>By plotting the first and third colums, and first and fourth colums, we get the following potential profile:</p>
<a class="reference internal image-reference" href="../../../_images/potential_profile_pbc.png"><img alt="../../../_images/potential_profile_pbc.png" class="align-center" src="../../../_images/potential_profile_pbc.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>We can see that the electric field is applied to the slab because of the periodic boundary condition.</p>
<p>We also extract the planar average of chargen and potential from the ESM calculations as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ state2chgpro.sh nfout_gdiis_esm &gt; chgpro.dat_esm
</pre></div>
</div>
<p>and we get the following:</p>
<a class="reference internal image-reference" href="../../../_images/potential_profile_esm.png"><img alt="../../../_images/potential_profile_esm.png" class="align-center" src="../../../_images/potential_profile_esm.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>We can see that the potentials are flat in the vacuum region. Mind that the slab is locased near the origin (z=0). The discontinuity is by the plotting reason (actually they are disconnected because we do not use the periodic boundary condition with the ESM method).</p>
</section>
</section>
<section id="graphene">
<h2>Graphene<a class="headerlink" href="#graphene" title="Permalink to this headline">¶</a></h2>
<p>In this example (<code class="docutils literal notranslate"><span class="pre">GR</span></code>), how to optimize the cell parameter, how to calculate the band structure, and how to calculate density of states, are described.</p>
<ul class="simple">
<li><p>Sample input file <code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>WF_OPT    DAV
NTYP      <span class="m">1</span>
NATM      <span class="m">2</span>
TYPE      <span class="m">0</span>
<span class="c1">#NSPG     1017</span>
GMAX      <span class="m">5</span>.00
GMAXP    <span class="m">15</span>.00
KPOINT_MESH   <span class="m">12</span>  <span class="m">12</span>  <span class="m">1</span>
KPOINT_SHIFT  F   F   F
NSCF      <span class="m">400</span>
WAY_MIX   <span class="m">3</span>
MIX_ALPHA <span class="m">0</span>.4
SMEARING  MP
WIDTH     <span class="m">0</span>.0010
EDELTA    <span class="m">0</span>.1000D-11
NEG       <span class="m">24</span>
CELL      <span class="m">4</span>.6591  <span class="m">4</span>.6591 <span class="m">18</span>.89726878  <span class="m">90</span>.00  <span class="m">90</span>.00 <span class="m">120</span>.00
<span class="p">&amp;</span>ATOMIC_SPECIES
 C  <span class="m">12</span>.0107 pot.C_pbe3
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES CRYSTAL
      <span class="m">0</span>.00000000000      <span class="m">0</span>.00000000000      <span class="m">0</span>.00000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
      <span class="m">0</span>.33333333333      <span class="m">0</span>.66666666667      <span class="m">0</span>.00000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<section id="id3">
<h3>Cell optimization<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Go to the subdirectory <code class="docutils literal notranslate"><span class="pre">Opt/</span></code> and as in the example of silicon, we manually change the in-plane lattice parameter (a and b) by 0.02 Bohr as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL      <span class="m">4</span>.54 <span class="m">4</span>.54 <span class="m">18</span>.89726878  <span class="m">90</span>.00  <span class="m">90</span>.00 <span class="m">120</span>.00
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL      <span class="m">4</span>.56 <span class="m">4</span>.56 <span class="m">18</span>.89726878  <span class="m">90</span>.00  <span class="m">90</span>.00 <span class="m">120</span>.00
</pre></div>
</div>
<p>…</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CELL      <span class="m">4</span>.74 <span class="m">4</span>.74 <span class="m">18</span>.89726878  <span class="m">90</span>.00  <span class="m">90</span>.00 <span class="m">120</span>.00
</pre></div>
</div>
<p>For each lattice constant we prepare an input file as <code class="docutils literal notranslate"><span class="pre">nfinp_scf_a4.54</span></code>, <code class="docutils literal notranslate"><span class="pre">nfinp_scf_a4.56</span></code>, … <code class="docutils literal notranslate"><span class="pre">nfinp_scf_4.74</span></code> and execute STATE (min. and max. values, as well as the interval are arbitrary) by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>Alternatively one can use <code class="docutils literal notranslate"><span class="pre">qsub_opt_cmd.sh</span></code> to automatically run a set of calculations.</p>
<p>We then plot the total energy as a function of lattice parameter (use getetot.sh in the same directory), and fit it to any function. In this example, let us use 6th order polynomial. The result looks like:</p>
<a class="reference internal image-reference" href="../../../_images/etot_gr_raw.png"><img alt="../../../_images/etot_gr_raw.png" class="align-center" src="../../../_images/etot_gr_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>The minimum (equilibrium) can be found at a=4.6591 (Bohr). Compare with the experimental value.</p>
</section>
<section id="band-structure-calculation">
<h3>Band structure calculation<a class="headerlink" href="#band-structure-calculation" title="Permalink to this headline">¶</a></h3>
<p>We then use the theoretically optimized lattice parameter to calculate the band structure of graphene.
Change directory to <code class="docutils literal notranslate"><span class="pre">Band/</span></code> and the files <code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code> and <code class="docutils literal notranslate"><span class="pre">nfinp_band</span></code> can be found.</p>
<p>To calculate the band structure, first we perform an SCF calculation to obtain a converged charge density (or potential) and perform a fixed charge (potential) non-SCF calculation for the high-symmetry k-points.</p>
<p>First perform the SCF calculation by using the following input file (<code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">0</span>
<span class="c1">#NSPG     1017</span>
<span class="n">GMAX</span>      <span class="mf">5.00</span>
<span class="n">GMAXP</span>    <span class="mf">15.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">F</span>   <span class="n">F</span>   <span class="n">F</span>
<span class="n">NSCF</span>      <span class="mi">400</span>
<span class="n">WAY_MIX</span>   <span class="mi">3</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.4</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0010</span>
<span class="n">EDELTA</span>    <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span>
<span class="n">NEG</span>       <span class="mi">24</span>
<span class="n">CELL</span>      <span class="mf">4.6591</span>  <span class="mf">4.6591</span> <span class="mf">18.89726878</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="mf">120.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span> <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.33333333333</span>      <span class="mf">0.66666666667</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>After converging the charge/potential, we perform the non-SCF band structure calculation by using the following input (<code class="docutils literal notranslate"><span class="pre">nfinp_band</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>      <span class="n">BAND</span>
<span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">0</span>
<span class="c1">#NSPG     1017</span>
<span class="n">GMAX</span>      <span class="mf">5.00</span>
<span class="n">GMAXP</span>    <span class="mf">15.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">F</span>   <span class="n">F</span>   <span class="n">F</span>
<span class="n">NSCF</span>      <span class="mi">400</span>
<span class="n">WAY_MIX</span>   <span class="mi">3</span>
<span class="n">MIX_WHAT</span>  <span class="mi">1</span>
<span class="n">KBXMIX</span>    <span class="mi">20</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.4</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0010</span>
<span class="n">EDELTA</span>    <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span>
<span class="n">NEG</span>       <span class="mi">24</span>
<span class="n">CELL</span>      <span class="mf">4.6591</span>  <span class="mf">4.6591</span> <span class="mf">18.89726878</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="mf">120.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span> <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.33333333333</span>      <span class="mf">0.66666666667</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">KPOINTS_BAND</span>
 <span class="n">NKSEG</span> <span class="mi">3</span>
 <span class="n">KMESH</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
 <span class="n">KPOINTS</span>
 <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.66666667</span> <span class="o">-</span><span class="mf">0.33333333</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.50000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>For the band structure calculation, we use the following keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>      <span class="n">BAND</span>
</pre></div>
</div>
<p>To specify the high symmetry k-points, we add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">KPOINTS_BAND</span>
 <span class="n">NKSEG</span> <span class="mi">3</span>
 <span class="n">KMESH</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
 <span class="n">KPOINTS</span>
 <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.66666667</span> <span class="o">-</span><span class="mf">0.33333333</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.50000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
 <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Here we define the number of k-point segments by the keyword <code class="docutils literal notranslate"><span class="pre">NKSEG</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NKSEG</span> <span class="mi">3</span>
</pre></div>
</div>
<p>k-point mesh for each segment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KMESH</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
</pre></div>
</div>
<p>and NKSEG+1 k-points defining each segments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KPOINTS</span>
<span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
<span class="mf">0.66666667</span> <span class="o">-</span><span class="mf">0.33333333</span>  <span class="mf">0.00000000</span>
<span class="mf">0.50000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
<span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>  <span class="mf">0.00000000</span>
</pre></div>
</div>
<p>Here the k-points are given in the unit of the reciprocal lattice vectors.
To give the k-points in the cartesian coordinate, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KPOINTS</span> <span class="n">CARTESIAN</span>
</pre></div>
</div>
<p>Run the band structure calculation by replacing the input file with <code class="docutils literal notranslate"><span class="pre">nfinp_band</span></code> in <code class="docutils literal notranslate"><span class="pre">qsub_cmd.sh</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qsub qsub_cmd.sh
</pre></div>
</div>
<p>we obtain the file <code class="docutils literal notranslate"><span class="pre">energy.data</span></code>, which containg the Kohn-Sham eigenvalues, along with the k-points.
However, we cannot plot the band structure directory from <code class="docutils literal notranslate"><span class="pre">energy.data</span></code> and should be processed properly.
To convert the <code class="docutils literal notranslate"><span class="pre">energy.data</span></code> file into a plottable XY data, we use the <code class="docutils literal notranslate"><span class="pre">energy2band</span></code> program.
Type</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ energy2band
</pre></div>
</div>
<p>and you will be asked the numbers of bands considered, the number of bands to be plotted (can be the same as the previous one), the number of k-points considered (in this example, the eigenvalues at 61 k-points are calculated), and the energy origin (here, the Fermi level obtained in the SCF calculation will be used).
If the numbers are given properly, we obtain the file <code class="docutils literal notranslate"><span class="pre">band.data</span></code>, which can be used to plot the band directory by using gnuplot or grace.</p>
<p>Here is how the band structure looks like:</p>
<a class="reference internal image-reference" href="../../../_images/band_gr_raw.png"><img alt="../../../_images/band_gr_raw.png" class="align-center" src="../../../_images/band_gr_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
</section>
<section id="density-of-states">
<h3>Density of states<a class="headerlink" href="#density-of-states" title="Permalink to this headline">¶</a></h3>
<p>Now let us calculate the density of states (DOS) and projected DOS (PDOS) onto the atomic orbital.</p>
<p>Change directory to <code class="docutils literal notranslate"><span class="pre">DOS/</span></code> and we can find the directory <code class="docutils literal notranslate"><span class="pre">12x12/</span></code>, <code class="docutils literal notranslate"><span class="pre">16x16/</span></code>, and <code class="docutils literal notranslate"><span class="pre">24x24/</span></code>, which indicate the k-point mesh used the calculation.</p>
<p>Let us change directory to <code class="docutils literal notranslate"><span class="pre">12x12</span></code> and have a look at the input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">0</span>
<span class="c1">#NSPG     1017</span>
<span class="n">GMAX</span>      <span class="mf">5.00</span>
<span class="n">GMAXP</span>    <span class="mf">15.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">F</span>   <span class="n">F</span>   <span class="n">F</span>
<span class="n">NSCF</span>      <span class="mi">400</span>
<span class="n">WAY_MIX</span>   <span class="mi">3</span>
<span class="n">MIX_WHAT</span>  <span class="mi">1</span>
<span class="n">KBXMIX</span>    <span class="mi">20</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.4</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0010</span>
<span class="n">EDELTA</span>    <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span>
<span class="n">NEG</span>       <span class="mi">24</span>
<span class="n">CELL</span>      <span class="mf">4.6591</span>  <span class="mf">4.6591</span> <span class="mf">18.89726878</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="mf">120.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span> <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.33333333333</span>      <span class="mf">0.66666666667</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">DOS</span>
 <span class="n">EMIN</span> <span class="o">-</span><span class="mf">20.0</span>
 <span class="n">EMAX</span>  <span class="mf">10.0</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>The total density of states is printed to <code class="docutils literal notranslate"><span class="pre">dos.data</span></code>, and the default energy window is from -0.5  to + 0.3 Hartree (-13.6057 to 8.1634 eV relative to the Fermi level).
To change the energy windown, we use the <code class="docutils literal notranslate"><span class="pre">&amp;DOS...&amp;END</span></code> block as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">DOS</span>
 <span class="n">EMIN</span> <span class="o">-</span><span class="mf">20.0</span>
 <span class="n">EMAX</span>  <span class="mf">10.0</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>where minimum and maximum energies are given in eV.</p>
<p>By Running the SCF calculation in each directory, we can observe the convergence of the density of states:</p>
<a class="reference internal image-reference" href="../../../_images/dos_gr_raw.png"><img alt="../../../_images/dos_gr_raw.png" class="align-center" src="../../../_images/dos_gr_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
<p>Finally, in the <code class="docutils literal notranslate"><span class="pre">DOS/24x24</span></code> directory, we calculate PDOS.
The PDOS can be calculated at the end of the SCF calculation, or as a postprocess.
To compute PDOS in the SCF calculation, we can use the following <code class="docutils literal notranslate"><span class="pre">nfinp_scf+pdos</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">0</span>
<span class="c1">#NSPG     1017</span>
<span class="n">GMAX</span>      <span class="mf">5.00</span>
<span class="n">GMAXP</span>    <span class="mf">15.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">F</span>   <span class="n">F</span>   <span class="n">F</span>
<span class="n">NSCF</span>      <span class="mi">400</span>
<span class="n">WAY_MIX</span>   <span class="mi">3</span>
<span class="n">MIX_WHAT</span>  <span class="mi">1</span>
<span class="n">KBXMIX</span>    <span class="mi">20</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.4</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0010</span>
<span class="n">EDELTA</span>    <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span>
<span class="n">NEG</span>       <span class="mi">24</span>
<span class="n">CELL</span>      <span class="mf">4.6591</span>  <span class="mf">4.6591</span> <span class="mf">18.89726878</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="mf">120.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span> <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.33333333333</span>      <span class="mf">0.66666666667</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">PDOS</span>
 <span class="n">NPDOSAO</span> <span class="mi">1</span>
 <span class="n">IPDOST</span>  <span class="mi">1</span>
 <span class="n">EMIN</span>    <span class="o">-</span><span class="mf">20.00</span>
 <span class="n">EMAX</span>     <span class="mf">10.00</span>
 <span class="n">EWIDTH</span>    <span class="mf">0.10</span>
 <span class="n">NPDOSE</span>  <span class="mi">3001</span>
 <span class="n">RCUT</span>    <span class="mf">1.30</span>
 <span class="n">RWIDTH</span>  <span class="mf">0.10</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>where the block <code class="docutils literal notranslate"><span class="pre">&amp;PDOS...&amp;END</span></code> is added to set the parameters for the PDOS calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">PDOS</span>
 <span class="n">NPDOSAO</span> <span class="mi">1</span>
 <span class="n">IPDOST</span>  <span class="mi">1</span>
 <span class="n">EMIN</span>    <span class="o">-</span><span class="mf">20.00</span>
 <span class="n">EMAX</span>     <span class="mf">10.00</span>
 <span class="n">EWIDTH</span>    <span class="mf">0.10</span>
 <span class="n">NPDOSE</span>  <span class="mi">3001</span>
 <span class="n">RCUT</span>    <span class="mf">1.30</span>
 <span class="n">RWIDTH</span>  <span class="mf">0.10</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>For the post-processing PDOS calculation, the following file (<code class="docutils literal notranslate"><span class="pre">nfinp_pdos</span></code>) can be used</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>      <span class="n">PDOS</span>
<span class="n">WF_OPT</span>    <span class="n">DAV</span>
<span class="n">NTYP</span>      <span class="mi">1</span>
<span class="n">NATM</span>      <span class="mi">2</span>
<span class="n">TYPE</span>      <span class="mi">0</span>
<span class="c1">#NSPG     1017</span>
<span class="n">GMAX</span>      <span class="mf">5.00</span>
<span class="n">GMAXP</span>    <span class="mf">15.00</span>
<span class="n">KPOINT_MESH</span>   <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">1</span>
<span class="n">KPOINT_SHIFT</span>  <span class="n">F</span>   <span class="n">F</span>   <span class="n">F</span>
<span class="n">NSCF</span>      <span class="mi">400</span>
<span class="n">WAY_MIX</span>   <span class="mi">3</span>
<span class="n">MIX_WHAT</span>  <span class="mi">1</span>
<span class="n">KBXMIX</span>    <span class="mi">20</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.4</span>
<span class="n">SMEARING</span>  <span class="n">MP</span>
<span class="n">WIDTH</span>     <span class="mf">0.0010</span>
<span class="n">EDELTA</span>    <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span>
<span class="n">NEG</span>       <span class="mi">24</span>
<span class="n">CELL</span>      <span class="mf">4.6591</span>  <span class="mf">4.6591</span> <span class="mf">18.89726878</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="mf">120.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span> <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">CRYSTAL</span>
      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
      <span class="mf">0.33333333333</span>      <span class="mf">0.66666666667</span>      <span class="mf">0.00000000000</span>    <span class="mi">1</span>    <span class="mi">1</span>    <span class="mi">1</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">PDOS</span>
 <span class="n">NPDOSAO</span> <span class="mi">1</span>
 <span class="n">IPDOST</span>  <span class="mi">1</span>
 <span class="n">EMIN</span>    <span class="o">-</span><span class="mf">20.00</span>
 <span class="n">EMAX</span>     <span class="mf">10.00</span>
 <span class="n">EWIDTH</span>    <span class="mf">0.10</span>
 <span class="n">NPDOSE</span>  <span class="mi">3001</span>
 <span class="n">RCUT</span>    <span class="mf">1.30</span>
 <span class="n">RWIDTH</span>  <span class="mf">0.10</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>where the keyword <code class="docutils literal notranslate"><span class="pre">TASK</span></code> is used to perfom the PDOS calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>      <span class="n">PDOS</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">&amp;PDOS...&amp;END</span></code> block, number of atoms for which PDOSs are computed is defined by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NPDOSAO</span> <span class="mi">1</span>
</pre></div>
</div>
<p>and corresponding atomic indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IPDOST</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>Number of <code class="docutils literal notranslate"><span class="pre">IPDOST</span></code> should equal to <code class="docutils literal notranslate"><span class="pre">NPDOSAO</span></code>.
Minimum and maximum energies (in eV) and number of grid points for the energy are defined by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EMIN</span>    <span class="o">-</span><span class="mf">20.00</span>
<span class="n">EMAX</span>     <span class="mf">10.00</span>
<span class="n">NPDOSE</span>  <span class="mi">3001</span>
</pre></div>
</div>
<p>and the smearing width (in eV) for the gaussian is defined by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EWIDTH</span>    <span class="mf">0.10</span>
</pre></div>
</div>
<p>We cutoff the atomic orbitals at certain radius <code class="docutils literal notranslate"><span class="pre">RCUT</span></code> (in Bohr):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RCUT</span>    <span class="mf">1.30</span>
</pre></div>
</div>
<p>and the truncated orbital is smoothened by using the Fermi-Dirac type function with the width of <code class="docutils literal notranslate"><span class="pre">RWIDTH</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RWIDTH</span>  <span class="mf">0.10</span>
</pre></div>
</div>
<p>The number of <code class="docutils literal notranslate"><span class="pre">RCUT</span></code> and <code class="docutils literal notranslate"><span class="pre">RWIDTH</span></code> should corresponds to then number of atomic species (<code class="docutils literal notranslate"><span class="pre">NTYPE</span></code>).</p>
<p>The calculated PDOS for graphene can be visualized as:</p>
<a class="reference internal image-reference" href="../../../_images/pdos_gr_raw.png"><img alt="../../../_images/pdos_gr_raw.png" class="align-center" src="../../../_images/pdos_gr_raw.png" style="width: 603.2px; height: 549.6px;" /></a>
</section>
</section>
<section id="benzene">
<h2>Benzene<a class="headerlink" href="#benzene" title="Permalink to this headline">¶</a></h2>
<p>This example explain how to plot the molecular orbitals by using the benzene (C6H6) molecule.
The directory is <code class="docutils literal notranslate"><span class="pre">C6H6/</span></code></p>
<section id="id4">
<h3>SCF<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Let us start with the SCF calculation by using the following input <code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WF_OPT</span> <span class="n">DAV</span>
<span class="n">NTYP</span>   <span class="mi">2</span>
<span class="n">NATM</span>   <span class="mi">12</span>
<span class="n">TYPE</span>   <span class="mi">0</span>
<span class="n">GMAX</span>    <span class="mf">5.00</span>
<span class="n">GMAXP</span>  <span class="mf">15.00</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.8</span>
<span class="n">WIDTH</span>   <span class="mf">0.0010</span>
<span class="n">EDELTA</span>  <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>
<span class="n">NEG</span>     <span class="mi">24</span>
<span class="n">CELL</span>   <span class="mf">15.00</span>  <span class="mf">15.00</span>  <span class="mf">15.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span>  <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
 <span class="n">H</span>   <span class="mf">1.0079</span>  <span class="n">pot</span><span class="o">.</span><span class="n">H_lda3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">XYZ</span>
<span class="mi">12</span>
<span class="n">benzene</span> <span class="n">example</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">openbabel</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="n">XYZ_</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
  <span class="n">C</span>        <span class="mf">0.00000</span>        <span class="mf">1.40272</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">0.00000</span>        <span class="mf">2.49029</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>       <span class="o">-</span><span class="mf">1.21479</span>        <span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>       <span class="o">-</span><span class="mf">2.15666</span>        <span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>       <span class="o">-</span><span class="mf">1.21479</span>       <span class="o">-</span><span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>       <span class="o">-</span><span class="mf">2.15666</span>       <span class="o">-</span><span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">0.00000</span>       <span class="o">-</span><span class="mf">1.40272</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">0.00000</span>       <span class="o">-</span><span class="mf">2.49029</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">1.21479</span>       <span class="o">-</span><span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">2.15666</span>       <span class="o">-</span><span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">1.21479</span>        <span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">2.15666</span>        <span class="mf">1.24515</span>        <span class="mf">0.00000</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Here we show that the XYZ format can be used to give the atomic coordinates.</p>
<p>After the SCF is converged, wave functions in real space can be calculated by using <code class="docutils literal notranslate"><span class="pre">nfinp_prtwfc</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>   <span class="n">PRTWFC</span>
<span class="n">WF_OPT</span> <span class="n">DAV</span>
<span class="n">NTYP</span>   <span class="mi">2</span>
<span class="n">NATM</span>   <span class="mi">12</span>
<span class="n">TYPE</span>   <span class="mi">0</span>
<span class="n">GMAX</span>    <span class="mf">5.00</span>
<span class="n">GMAXP</span>  <span class="mf">15.00</span>
<span class="n">MIX_ALPHA</span> <span class="mf">0.8</span>
<span class="n">WIDTH</span>   <span class="mf">0.0010</span>
<span class="n">EDELTA</span>  <span class="mf">0.1000</span><span class="n">D</span><span class="o">-</span><span class="mi">08</span>
<span class="n">NEG</span>     <span class="mi">24</span>
<span class="n">CELL</span>   <span class="mf">15.00</span>  <span class="mf">15.00</span>  <span class="mf">15.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>
<span class="o">&amp;</span><span class="n">ATOMIC_SPECIES</span>
 <span class="n">C</span>  <span class="mf">12.0107</span>  <span class="n">pot</span><span class="o">.</span><span class="n">C_pbe3</span>
 <span class="n">H</span>   <span class="mf">1.0079</span>  <span class="n">pot</span><span class="o">.</span><span class="n">H_lda3</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">ATOMIC_COORDINATES</span> <span class="n">XYZ</span>
<span class="mi">12</span>
<span class="n">benzene</span> <span class="n">example</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">openbabel</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="n">XYZ_</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
  <span class="n">C</span>        <span class="mf">0.00000</span>        <span class="mf">1.40272</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">0.00000</span>        <span class="mf">2.49029</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>       <span class="o">-</span><span class="mf">1.21479</span>        <span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>       <span class="o">-</span><span class="mf">2.15666</span>        <span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>       <span class="o">-</span><span class="mf">1.21479</span>       <span class="o">-</span><span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>       <span class="o">-</span><span class="mf">2.15666</span>       <span class="o">-</span><span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">0.00000</span>       <span class="o">-</span><span class="mf">1.40272</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">0.00000</span>       <span class="o">-</span><span class="mf">2.49029</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">1.21479</span>       <span class="o">-</span><span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">2.15666</span>       <span class="o">-</span><span class="mf">1.24515</span>        <span class="mf">0.00000</span>
  <span class="n">C</span>        <span class="mf">1.21479</span>        <span class="mf">0.70136</span>        <span class="mf">0.00000</span>
  <span class="n">H</span>        <span class="mf">2.15666</span>        <span class="mf">1.24515</span>        <span class="mf">0.00000</span>
<span class="o">&amp;</span><span class="n">END</span>
<span class="o">&amp;</span><span class="n">PLOT</span>
 <span class="n">IKPT</span> <span class="mi">1</span>
 <span class="n">IBS</span>  <span class="mi">14</span>
 <span class="n">IBE</span>  <span class="mi">17</span>
 <span class="n">FORMAT</span> <span class="n">XSF</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Wave function plot can be activated by setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TASK</span>   <span class="n">PRTWFC</span>
</pre></div>
</div>
<p>and the k-points and range of bands of the wave functions to be plotted is given by the block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">PLOT</span>
 <span class="n">IKPT</span> <span class="mi">1</span>
 <span class="n">IBS</span>  <span class="mi">14</span>
 <span class="n">IBE</span>  <span class="mi">17</span>
 <span class="n">FORMAT</span> <span class="n">XSF</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">IKPT</span></code> is the index of the k-points, <code class="docutils literal notranslate"><span class="pre">IBS</span></code> and <code class="docutils literal notranslate"><span class="pre">IBE</span></code> are the indices of initial and final bands, respectively, and <code class="docutils literal notranslate"><span class="pre">FORMAT</span></code> is to specify the format of the output wave functions.
In this example, following files may be created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nfwfn_kpt0001_band0014_re</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0014_im</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0015_re</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0015_im</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0016_re</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0016_im</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0017_re</span><span class="o">.</span><span class="n">xsf</span>
<span class="n">nfwfn_kpt0001_band0017_im</span><span class="o">.</span><span class="n">xsf</span>
</pre></div>
</div>
<p>Real part (*_re*) and image part (*_im*) of the wave functions are generated separately.
These wave functions can be plotted by using XCrySDen, VESTA, VMD, or alike.
The real parts of the doubly degenerated highest occupied molecular orbitals (HOMOs) are visualized and shown below:</p>
<a class="reference internal image-reference" href="../../../_images/homo_c6h6.png"><img alt="../../../_images/homo_c6h6.png" class="align-center" src="../../../_images/homo_c6h6.png" style="width: 315.0px; height: 158.0px;" /></a>
</section>
</section>
<section id="tio2">
<h2>TiO2<a class="headerlink" href="#tio2" title="Permalink to this headline">¶</a></h2>
<p>This example explains hot to perform a calculation with the on-site Coulomb potential correction (DFT+U) by using rutile.</p>
<ul class="simple">
<li><p>Directory <code class="docutils literal notranslate"><span class="pre">TiO2/</span></code></p></li>
<li><p>Input file for the DFT calculation <code class="docutils literal notranslate"><span class="pre">nfinp_scf</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>WF_OPT DAV
NTYP <span class="m">2</span>
NATM <span class="m">6</span>
TYPE <span class="m">0</span>
NSPG <span class="m">136</span>
GMAX    <span class="m">5</span>.00
GMAXP  <span class="m">15</span>.00
KPOINT_MESH    <span class="m">6</span>  <span class="m">6</span>  <span class="m">8</span>
KPOINT_SHIFT   T  T  T
NSCF    <span class="m">200</span>
KBXMIX <span class="m">10</span>
MIX_ALPHA <span class="m">0</span>.1
WIDTH   <span class="m">0</span>.0002
EDELTA  <span class="m">0</span>.1000D-09
NEG    <span class="m">30</span>
CELL    <span class="m">8</span>.68080000   <span class="m">8</span>.68080000   <span class="m">5</span>.58940000  <span class="m">90</span>.00000000  <span class="m">90</span>.00000000  <span class="m">90</span>.00000000
XCTYPE  ldapw91
<span class="p">&amp;</span>ATOMIC_SPECIES
 Ti  <span class="m">47</span>.947900 pot.Ti_pbe3
 O   <span class="m">15</span>.994900 pot.O_pbe3
<span class="p">&amp;</span>END
<span class="p">&amp;</span>ATOMIC_COORDINATES CRYSTAL
      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">0</span>    <span class="m">1</span>
      <span class="m">0</span>.500000000000      <span class="m">0</span>.500000000000      <span class="m">0</span>.500000000000    <span class="m">1</span>    <span class="m">0</span>    <span class="m">1</span>
      <span class="m">0</span>.304829777700      <span class="m">0</span>.304829777700      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
      <span class="m">0</span>.804829777700      <span class="m">0</span>.195170222300      <span class="m">0</span>.500000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
     -0.304829777700     -0.304829777700      <span class="m">0</span>.000000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
     -0.804829777700     -0.195170222300      <span class="m">0</span>.500000000000    <span class="m">1</span>    <span class="m">1</span>    <span class="m">2</span>
<span class="p">&amp;</span>END
<span class="p">&amp;</span>HUBBARD
 NPROJ     <span class="m">2</span>
 IPROJ     <span class="m">1</span>    <span class="m">2</span>
 HUBBARD_U <span class="m">8</span>.00 <span class="m">8</span>.00
 RCUT      <span class="m">2</span>.30 <span class="m">1</span>.60
 RSMEAR    <span class="m">0</span>.20 <span class="m">0</span>.12
 NLMU      <span class="m">5</span>
 LMU       <span class="m">5</span>    <span class="m">6</span>    <span class="m">7</span>    <span class="m">8</span>    <span class="m">9</span>
<span class="p">&amp;</span>END
</pre></div>
</div>
<p>Note for this calculation, PW91 LDA (ldapw91) functional was used by setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XCTYPE</span>  <span class="n">ldapw91</span>
</pre></div>
</div>
<p>For the on-site Coulomb potential (Hubbard U), the <code class="docutils literal notranslate"><span class="pre">&amp;HUBBARD...&amp;END</span></code> block is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">HUBBARD</span>
 <span class="n">NPROJ</span>     <span class="mi">2</span>
 <span class="n">IPROJ</span>     <span class="mi">1</span>    <span class="mi">2</span>
 <span class="n">HUBBARD_U</span> <span class="mf">8.00</span> <span class="mf">8.00</span>
 <span class="n">RCUT</span>      <span class="mf">2.30</span> <span class="mf">1.60</span>
 <span class="n">RSMEAR</span>    <span class="mf">0.20</span> <span class="mf">0.12</span>
 <span class="n">NLMU</span>      <span class="mi">5</span>
 <span class="n">LMU</span>       <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>    <span class="mi">8</span>    <span class="mi">9</span>
<span class="o">&amp;</span><span class="n">END</span>
</pre></div>
</div>
<p>Number of projectors are set by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NPROJ</span>     <span class="mi">2</span>
</pre></div>
</div>
<p>Indices for atoms on which the Hubbard U correction is applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IPROJ</span>     <span class="mi">1</span>    <span class="mi">2</span>
</pre></div>
</div>
<p>Effective Hubbard U is defined by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HUBBARD_U</span> <span class="mf">8.00</span> <span class="mf">8.00</span>
</pre></div>
</div>
<p>Cutoff radii and smearing width for the localized orbitals are set by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RCUT</span>      <span class="mf">2.30</span> <span class="mf">1.60</span>
<span class="n">RSMEAR</span>    <span class="mf">0.20</span> <span class="mf">0.12</span>
</pre></div>
</div>
<p>Number of the m components (usually 5 for the d state) is set by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NLMU</span>      <span class="mi">5</span>
</pre></div>
</div>
<p>and the indices for the m components are give by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LMU</span>       <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>    <span class="mi">8</span>    <span class="mi">9</span>
</pre></div>
</div>
<p>Compare the result (for instance, density of states written to <code class="docutils literal notranslate"><span class="pre">dos.data</span></code>)  wihtout the Hubbard U correction.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../../index.html" class="btn btn-neutral float-left" title="Welcome to the STATE hands-on tutorial!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Advanced/index.html" class="btn btn-neutral float-right" title="Advanced course @ CMD40" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Ikutaro Hamada.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>